extends: [cmake_package]

sources:
- key: tar.gz:tiwcmpwvbkpyc7tyyuprtxiziaq7inho
  url: https://github.com/projectchrono/chrono/archive/51cb0c88a3ae1eece127322fea081e9a140de3d4.tar.gz

defaults:
  relocatable: false

dependencies:
  build:
    - bzip2
    - python
    - irrlicht
    - zlib
    - openjpeg
    - png
    - swig
    - blaze
    - boost
    - libjpeg

build_stages:
- name: configure
  extra:
    - '-DENABLE_UNIT_CASCADE:BOOL=ON'
    - '-DENABLE_MODULE_FEA:BOOL=ON'
    - '-DENABLE_MODULE_IRRLICHT:BOOL=ON'
    - '-DENABLE_MODULE_POSTPROCESS:BOOL=ON'
    - '-DENABLE_MODULE_VEHICLE:BOOL=ON'
    - '-DENABLE_MODULE_FSI:BOOL=ON'
    - '-DENABLE_OPENMP:BOOL=ON'
    - '-DENABLE_MODULE_PYTHON:BOOL=ON'
    - '-DENABLE_MODULE_COSIMULATION:BOOL=OFF'
    - '-DENABLE_MODULE_MATLAB:BOOL=OFF'
    - '-DENABLE_MODULE_MKL:BOOL=OFF'
    - '-DENABLE_MODULE_PARALLEL:BOOL=OFF'
    - '-DENABLE_MODULE_OPENGL:BOOL=OFF'
    - '-DENABLE_MODULE_OGRE:BOOL=OFF'
    - '-DCMAKE_BUILD_TYPE:STRING=Release'
    - '-DBLAZE_DIR:PATH=${BLAZE_DIR}'
    - '-DBOOST_DIR:PATH=${BOOST_DIR}/include'

#- after: install
#  handler: bash
#  bash: |
#    mv lib64 lib
#    mkdir -p lib/python2.6/site-packages/chrono
#    mv share/chrono/python lib/python2.6/site-packages/chrono
