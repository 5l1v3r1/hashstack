extends: [cmake_package]
dependencies:
  build: [boost, png, qt, zlib, bzip2, gdal, hdf5,
          mpi, netcdf4, netcdf4cpp, freetype,
          python, numpy, matplotlib, libxml2,
          paraview, remus, vxl, kml, molequeue, smtk, zmq, {{build_with}}]

sources:
- key: git:b24225a52187a124f5f83bdb7212d363f9254519
  url: git://public.kitware.com/CMB.git

build_stages:
- name: configure
  mode: override
  extra: [
          '-DCMAKE_C_COMPILER:FILEPATH={{HOST_MPICC}}',
          '-DCMAKE_CXX_COMPILER:FILEPATH={{HOST_MPICXX}}',
          '-DBUILD_SHARED_LIBS:BOOL=ON',
          '-DBUILD_TESTING:BOOL=OFF',
          '-DKML_DIR:PATH=${KML_DIR}',
          '-DGDAL_DIR:PATH=${GDAL_DIR}',
          '-DParaView_DIR:PATH=${PARAVIEW_DIR}',
          '-DMoleQueue_DIR:PATH=${MOLEQUEUE_DIR}',
          '-DCMAKE_CXX_FLAGS:STRING="${CPPFLAGS}"',
          ]
