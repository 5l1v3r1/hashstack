extends: [autotools_package]

dependencies:
  build: [libunwind, pkg-config]
  run: [libunwind, pkg-config]

sources:
- key: tar.gz:n6rhjdy2zx2e25ickpqwbt3ofzzfoezj
  url: https://github.com/gperftools/gperftools/releases/download/gperftools-2.5/gperftools-2.5.tar.gz

build_stages:
- when: compiler == 'gcc'
  name: optimization_flags
  after: prologue
  before: configure
  handler: bash
  bash: |
    export CXXFLAGS="-fPIC -O3 -march=native -ffast-math -funroll-loops"

when_build_dependency:
- prepend_path: PKG_CONFIG_PATH
  value: '${ARTIFACT}/lib/pkgconfig'
