parameters:
- name: version
  type: version
  default: 3.0.13

- name: relocatable
  type: bool
  default: false

extends: [autotools_package]

dependencies:
  build: [gnu-sed]

sources:
- key:
    when version == 3.0.13: tar.gz:dxo54faayo6lo5e5hgahdl4iypshkqcy
  url: ftp://sourceware.org/pub/libffi/libffi-{{version}}.tar.gz

when_build_dependency:
- prepend_path: PKG_CONFIG_PATH
  value: '${ARTIFACT}/lib/pkgconfig'

build_stages:
  - name: link_lib64_to_lib
    before: configure
    handler: bash
    bash: |
      # Always use /lib instead of sometimes /lib64
      sed -i 's:@toolexeclibdir@:$(libdir):g' Makefile.in
