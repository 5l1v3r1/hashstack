parameters:
- name: version
  type: version
  default: 1.5.0

# lib/CMake/mshr/mshr-config.cmake contains hard-coded path
- name: relocatable
  type: bool
  default: false

extends: [cmake_package]

dependencies:
  build: [python, boost, dolfin, gmp, mpfr, mpi, swig, +vtk]

sources:
- url: https://bitbucket.org/fenics-project/mshr/downloads/mshr-{{version}}.tar.gz
  key:
    when version == 1.5.0: tar.gz:6nto4vmuuwnifcj6li7p7iv4mxzzdso4

build_stages:
- name: configure
  extra: ['-D BUILD_SHARED_LIBS:BOOL=ON',
          '-D BOOST_ROOT:PATH="${BOOST_DIR}"']

- when: not vtk
  name: configure
  mode: update
  extra: ['-D MSHR_ENABLE_VTK:BOOL=OFF']

- when: vtk
  name: configure
  mode: update
  extra: ['-D MSHR_ENABLE_VTK:BOOL=ON']
