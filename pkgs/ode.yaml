parameters:
- name: version
  type: version
  default: 0.13

- name: relocatable
  type: bool
  default: false

extends: [autotools_package]

sources:
- key:
    when version == 0.13: tar.gz:76y7d3stirmjjzqe5ioftrhbr4ui3wj5
  url: http://sourceforge.net/projects/opende/files/ODE/{{version}}/ode-{{version}}.tar.gz

dependencies:
  build: [python, cython, pkg-config]
  run: [python, cython, pkg-config]

build_stages:
- name: configure
  extra: [
    "--enable-double-precision",
    "--with-trimesh=opcode",
    "--enable-new-trimesh",
    "--enable-shared"]

- name: install_python_bindings
  after: install
  handler: bash
  bash: |
    cd bindings/python
    PKG_CONFIG_PATH=../.. ${PYTHON} setup.py build_ext -R ${ARTIFACT}/lib install --prefix=${ARTIFACT}
