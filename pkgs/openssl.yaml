extends: [autotools_package]
dependencies:
  build: [zlib]

sources:
  - url: https://www.openssl.org/source/openssl-1.0.1e.tar.gz
    key: tar.gz:65hrl2gi74i2upk3wxzhnuqc5qmnojdo

build_stages:

  - when: platform == 'linux'
    name: set_flags
    before: configure
    handler: bash
    bash: |
      export OPENSSL_EXTRA_FLAGS="-Wl,-rpath=$ARTIFACT/lib -Wl,-rpath=$ZLIB_DIR/lib"

  - name: configure
    mode: replace
    handler: bash
    bash: |
      ./config --prefix=$ARTIFACT shared zlib-dynamic -I$ZLIB_DIR/include $OPENSSL_EXTRA_FLAGS
