when platform != 'linux':
  extends: [distutils_package]
when platform == 'linux':
  extends: [setuptools_package, libflags]
dependencies:
  build: [lapack, numpy]
  run: [lapack, numpy]

sources:
- key: tar.gz:rk3otsaix4x3h2cxntmm6bzcnwonygfq
  url: https://github.com/scipy/scipy/releases/download/v0.18.1/scipy-0.18.1.tar.gz

build_stages:
  - when: platform == 'linux'
    name: set-lapack-paths
    after: libflags
    before: install
    handler: bash
    bash: |
      export LDFLAGS="$LDFLAGS -shared"
      #export ATLAS=$LAPACK_DIR
      #export OPENBLAS=$BLAS_DIR
      export LAPACK=$LAPACK_DIR
