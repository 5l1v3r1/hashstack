extends: [cmake_package]
dependencies:
  build: [mpi, parmetis, zoltan]

sources:
  - url: https://github.com/SCOREC/core.git
    key: git:e219777edd875d35096dfedd7197300b8e2f3837
    
defaults:
  relocatable: true

build_stages:

- name: setup_builddir
  after: prologue
  handler: bash
  bash: |
    mkdir -p _build
    cd _build

- name: configure
  debug: true
  extra: [
  '-DBUILD_EXES:BOOL=OFF',
  '-DBUILD_SHARED_LIBS:BOOL=ON',
  '-DCMAKE_C_COMPILER:PATH=${MPICC}',
  '-DCMAKE_CXX_COMPILER:PATH=${MPICXX}',
  '-DENABLE_ZOLTAN:BOOL=ON',
  '-DENABLE_SIMMETRIX:BOOL=OFF',
  '-DZOLTAN_PREFIX:PATH=${ZOLTAN_DIR}',
  '-DPARMETIS_PREFIX:PATH=${PARMETIS_DIR}',
  ]
