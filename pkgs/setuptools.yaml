parameters:
- name: version
  type: version
  default: 3.4.3

extends: [distutils_package]

dependencies:
  build: [python]

sources:
- url: https://pypi.python.org/packages/source/s/setuptools/setuptools-{{version}}.tar.gz
  key:
    when version == 3.4.3: tar.gz:yfr3o4jkjyuvq7cmwfn52gmjt7xmiopn

build_stages:
  - name: install
    mode: override
    handler: bash
    bash: |
      ${PYTHON} setup.py install --prefix=. --root=${ARTIFACT} --single-version-externally-managed

  - when: python_framework
    name: install
    mode: override
    handler: bash
    bash: |
      ${PYTHON} setup.py install --prefix=. --root=${ARTIFACT}/Python.framework/Versions/{{pyver}} --single-version-externally-managed

when_build_dependency:
  - when: not python_framework
    prepend_path: PYTHONPATH
    value: '${ARTIFACT}/lib/python{{pyver}}/site-packages'

  - when: python_framework
    prepend_path: PYTHONPATH
    value: '${ARTIFACT}/Python.framework/Versions/{{pyver}}/lib/python{{pyver}}/site-packages'
