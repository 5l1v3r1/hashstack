parameters:
- name: version
  type: version
  default: 1.5.1.1

extends: [distutils_package]

dependencies:
  build: [cln, ginac, pkg-config, swig]

sources:
- url: http://downloads.sourceforge.net/swiginac.berlios/swiginac-{{version}}.tgz
  key:
    when version == 1.5.1.1: tar.gz:4am3idfmfgyhbzzegk4xzscxnaw2ifxf

build_stages:
- name: build
  after: setup_dirs
  before: install
  handler: bash
  bash: |
    ${PYTHON} setup.py build

- when: platform == 'linux' 
  name: fix-rpath
  after: install
  handler: bash
  bash: |
    ${PATCHELF} --set-rpath ${CLN_DIR}/lib:${GINAC_DIR}/lib ${ARTIFACT}/lib/python{{pyver}}/site-packages/_swiginac.so
